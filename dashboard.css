/* ==========================================================================
   1. CORE VARIABLES
   ========================================================================== */
:root {
  --max: 1800px;
  --gutter: clamp(16px, 2vw, 24px);
  --gap: 16px;
  --text: #eceff4;
  --muted: #d8dee9;
  --card: rgba(46, 52, 64, 0.4);
  --border: rgba(216, 222, 233, 0.1);
  --shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
  --accent: #88c0d0;
  --radius: 12px;
  
  /* Grid & Tile Defaults */
  --col-min: 280px; 
  --tile-h: 70px;
  --tile-icon: 44px;
}

/* ==========================================================================
   2. THEMES (Integrated & Overriden)
   ========================================================================== */
[data-theme="light"] {
  --text: #2e3440; --muted: #4c566a; --card: rgba(255, 255, 255, 0.8);
  --border: rgba(0, 0, 0, 0.1); background: #eceff4;
}

[data-theme="dark"] {
  --text: #eceff4; --muted: #d8dee9; --card: rgba(46, 52, 64, 0.5);
  --border: rgba(255, 255, 255, 0.05); background: #2e3440;
}

[data-theme="frost"] {
  --nord0: #2e3440; --nord1: #3b4252; --nord2: #434c5e; --nord8: #88c0d0;
  --text: #eceff4; --muted: #a3be8c; --accent: #88c0d0;
  --card: rgba(59, 66, 82, 0.95);
  --border: rgba(136, 192, 208, 0.2);
  background: var(--nord0) !important;
}

[data-theme="midnight"] {
  background: radial-gradient(circle at center, #0a0f1e, #02040c);
}

/* ==========================================================================
   3. BASE LAYOUT
   ========================================================================== */
* { box-sizing: border-box; }
body {
  margin: 0; font-family: 'Quicksand', sans-serif;
  color: var(--text); background-attachment: fixed;
}

/* Layout Mode Overrides */
body[data-layout="compact"] { --col-min: 220px; --tile-h: 58px; --tile-icon: 36px; }
body[data-layout="large"] { --col-min: 320px; --tile-h: 84px; --tile-icon: 52px; }

.app { min-height: 100vh; display: flex; flex-direction: column; }

/* ==========================================================================
   4. TOPBAR & BRANDING
   ========================================================================== */
.topbar {
  position: sticky; top: 0; z-index: 100;
  backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
  background: color-mix(in srgb, var(--card) 90%, black);
  border-bottom: 1px solid var(--border);
}
.topbar-inner {
  max-width: var(--max); margin: 0 auto; padding: 12px var(--gutter);
  display: grid; grid-template-columns: 1fr auto 1fr; align-items: center;
}

.brand { display: flex; align-items: center; gap: 12px; }
.brand-badge { width: 40px; height: 40px; flex-shrink: 0; }
.brand-badge img { width: 100%; height: 100%; object-fit: contain; }
.brand-title strong { font-size: 16px; white-space: nowrap; }

.search {
  background: rgba(0,0,0,0.15); border: 1px solid var(--border);
  border-radius: 20px; padding: 6px 16px; display: flex; align-items: center; gap: 10px;
  width: 320px;
}
.search input { background: transparent; border: 0; color: inherit; width: 100%; outline: none; }

/* ==========================================================================
   5. MAIN CONTENT & GRID
   ========================================================================== */
main { max-width: var(--max); margin: 0 auto; padding: 24px var(--gutter); width: 100%; }

/* Quick Row - Fixed sizing */
.quick-row {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: var(--gap);
  margin-bottom: 32px;
}

/* Main Grid - Prevents "Sliver" columns */
.columns {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(var(--col-min), 1fr));
  gap: var(--gap);
}

.category {
  background: var(--card); border: 1px solid var(--border);
  border-radius: var(--radius); overflow: hidden; height: fit-content;
}

.cat-head {
  padding: 14px; background: rgba(0,0,0,0.1);
  display: flex; align-items: center; gap: 10px;
  font-weight: 700; color: var(--accent); border-bottom: 1px solid var(--border);
}

.cat-body { padding: 12px; display: flex; flex-direction: column; gap: 8px; }

/* THE TILES - Icon Fixes */
.tile {
  display: flex; align-items: center; gap: 14px; padding: 10px 14px;
  min-height: var(--tile-h); background: rgba(255,255,255,0.03);
  border: 1px solid var(--border); border-radius: 10px;
  text-decoration: none; color: inherit; transition: all 0.2s ease;
}

.tile:hover {
  background: rgba(255,255,255,0.08); transform: translateY(-2px);
  border-color: var(--accent);
}

.tile-icon {
  width: var(--tile-icon); height: var(--tile-icon);
  flex-shrink: 0; display: flex; align-items: center; justify-content: center;
  background: rgba(0,0,0,0.1); border-radius: 8px; overflow: hidden;
}

.tile-icon img {
  width: 100%; height: 100%; object-fit: contain;
  padding: 4px; /* Prevents icons from touching edges */
}

.tile-text { min-width: 0; flex: 1; }
.tile-title { font-weight: 600; font-size: 14px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.tile-meta { font-size: 12px; color: var(--muted); opacity: 0.8; }

/* ==========================================================================
   6. PREFERENCES DRAWER (Fixed Overlay)
   ========================================================================== */
.prefs-panel {
  position: absolute; right: var(--gutter); top: 70px;
  background: var(--nord1); border: 1px solid var(--border);
  padding: 20px; border-radius: var(--radius);
  display: none; flex-direction: column; gap: 12px;
  box-shadow: 0 20px 50px rgba(0,0,0,0.5); z-index: 200;
  min-width: 200px;
}
body[data-prefs="open"] .prefs-panel { display: flex; }

.field { display: flex; align-items: center; justify-content: space-between; }
.field select { background: #2e3440; color: white; border: 1px solid var(--border); padding: 5px; border-radius: 4px; }

/* ==========================================================================
   7. RESPONSIVE ADJUSTMENTS
   ========================================================================== */
@media (max-width: 1000px) {
  .topbar-inner { grid-template-columns: 1fr auto; }
  .topbar-left { display: none; }
}

@media (max-width: 600px) {
  .columns { grid-template-columns: 1fr; }
  .quick-row { grid-template-columns: 1fr 1fr; }
}
